#!/bin/sh

indent() {
  sed -u 's/^/       /'
}

set-env() {
  PROFILE_PATH="$BUILD_DIR/.profile.d/curl.sh"
  echo "export $1=$2" >> $PROFILE_PATH
}

echo "-----> Upgrading curl"
DOWNLOAD_URL="http://archive.ubuntu.com/ubuntu/pool/main/c/curl/curl_7.52.1.orig.tar.gz"

echo "DOWNLOAD_URL = " $DOWNLOAD_URL | indent

wget $DOWNLOAD_URL
tar -xf curl_7.52.1.orig.tar.gz
cd curl-7.52.1
./configure --prefix=$1/vendor
make
make install

mkdir -p $BUILD_DIR/.profile.d
set-env PATH '$HOME/vendor/bin:$PATH'
set-env LD_LIBRARY_PATH '$HOME/vendor/lib:$LD_LIBRARY_PATH'
